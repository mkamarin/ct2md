# Cherrytree to Markdown (ct2md)
Convert [Cherrytree](https://www.giuspen.net/cherrytree/) documents to markdown for [Zettlr](https://www.zettlr.com/), [logseq](https://logseq.com/) or [Joplin](https://joplinapp.org/).
They all are excelent open source node taking applications, and allow the notes to be organized in a three or in a graph view.
Over the years, I have used Cherrytree for all my personal notes, and I have been very happy with it.
However, having the ability to convert those notes to markdown to use them in Zettlr, logseq or in Joplin is appealing, therefore this project.
This project allows me to explore the opportunities to move to a different notes taking application.
In addition, I like the idea of using markdown to take notes.

## Notes on the HTML generated in a Cherrytree Export
The HTML files generated by Cherrytree have the following characteristics:

1. A number is appended to the generated file names to disambiguate nodes with the same name. For example: `note` may be generated as `note_123.html`.
2. Spaces in node names are replaced with underscores. For example: `my note` becomes `my_note_324.html`.
3. The node structure of the Cherrytree tree is encoded in the file name, separating the nodes with two dashes. For example: if `my note` is leaf in a tree with three nested nodes a, b, and c (meaning `a/b/c/my note`) then the generated file name may be `a--b--c--my_note_87.html'.
4. The length of the generated file names seems to be limited to 142 characters. 
Longer than 142 character file names are truncated at the beginning of the file name.
So, if you have many levels on the tree, you may find new nodes being generated.
For example: "`first node/second node/tres node/.../twelve node/my note`" becomes "`econd_node--tres_node--...twelve_node--my_note_236.html`". 
Which is annoying because you get new branches, in this case starting with a folder (node) called "`econd_node`".
5. In some cases, I have seen a folder called 'htmlimport' being generated with all the files being duplicates. I don't know why or under which circumstances it is generated. But if you see that folder, you may want to delete it. I suggest to use something like `fdupes -r <Cherrytree-generated-folder>` to find duplicate files.
6. Cherrytree seems to truncate some of the exported images. If you open the image in a viewer you will see a partial image. I don't know why it happens, but it is annoying. 

Note that numbers 4, 5 and 6 can be considered bugs of Cherrytree. 
Number 4 (truncating file names by leaving the last 142 characters) could be detected and fixed in the code, but I have decided against it, because it may introduce other issues and in the future Cherrytree could fix o modify its algorithm or the number 142.

## Usage

1. Execute cherrytree and then go to `File -> Export -> Export to HTML`
2. In the Export to HTML dialog, select what you want to export (Selected Node Only, Selected Node and Subnodes, or All the Tree). Then select include Node Name and Link Tree in Every Page. But do not select Single File.
3. Execute ct2md.py

```
Usage:
  ct2md.py  [flags]

Flags:
   -c, --cherrytree <path> Executes cherrytree with <path> to a document to export to HTML
                           the document will be exported to the value in --path
   -C, --CherryTree <path> Same as --cherrytree, but executes it under flatpak
   -p, --path    <path>    Path to the cherrytree HTML export to be converted (default HTML)
                           If --cherrytree or --CherryTree is used then <path> is overwriten
                           with the output of the cherrytree export
   -o, --output  <path>    Output folder with the resulting markdown (default markdown)
   -d, --delete            Delete the content of the output folder if present
                           (Example: if output folder is markdown, then markdown/* is deleted)
   -v, --verbose           Produces verbose stdout output
   -s, --spaces            replaces underscores (_) in file names with spaces
                           (Example: file name 'foo_zoo.html' becomes 'foo zoo.md')
   -n, --numbers           remove the numbers appended by CherryTree to the file names
                           (Example: file name 'foo_274.html' becomes 'foo.md')
   -e, --embed             Embed files withe same name as a folder inside the folder
   -i, --id                Generates a Zettlr id using YYYYMMDDnnnn where nnnn is sequential
   -j, --joplin            Produces Joplin markdown (set -s, -n and -e)
   -l, --logseq            Produces Logseq markdown
   -z, --zettlr            Produces Zettlr markdown
   -h, --help              Prints this help
```
## Examples

### zettlr Example

```
./ct2md.py -i -z -p notes.ctb_HTML -o notes
```

This will generate markdown in the _notes_ folder. The input comes from the folder _notes.ctb_HTML_.
The generated markdown use the extensions that Zettlr expects, including the front matter.

### Joplin Example

```
./ct2md.py -j -p notes.ctb_HTML -o notes
```

This will generate markdown in the _notes_ folder. The input comes from the folder _notes.ctb_HTML_.
The generated folder (_notes_) can be imported in Joplin using `File -> Import -> MD - Markdown (Directory)`.
Note that images will import correctly, but they may had been truncated by the Cherrytree Export operation. 


